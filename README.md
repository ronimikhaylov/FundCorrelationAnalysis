# README

## Introduction

This Python script performs detailed financial analysis on a list of funds. It fetches historical price data, calculates daily returns, computes pairwise correlations and drawdowns, and creates visualizations. The output is a comprehensive set of metrics accompanied by a financial news article generated by OpenAI's GPT-3 model, offering an analysis based on the correlation matrix of returns for various ETFs.

## Required Libraries

You will need the following Python libraries:

- numpy: For numerical computations.
- pandas: To manipulate and analyze the data.
- yfinance: To fetch historical price data from Yahoo Finance.
- matplotlib: To create visualizations.
- seaborn: For additional visualization capabilities.
- openai: To generate a financial news article using the OpenAI GPT-3 model.

## Execution

Before running the script, replace `'OpenAI API KEY'` with your actual OpenAI API key. This is required for generating the financial news article analysis.

To run the script, navigate to the directory containing the file in your terminal, and type `python filename.py`.

## Code Breakdown

Here's a detailed explanation of what the script does:

1. **Import the necessary libraries.** These libraries provide the tools needed to fetch and analyze the data, create visualizations, and generate AI-based text.

2. **Fetch historical price data for a list of funds.** This data is fetched from Yahoo Finance using the `yfinance.download()` function.

3. **Calculate the daily returns for each fund.** Daily returns are calculated as the percentage change in price from one day to the next.

4. **Compute pairwise correlations between the returns of all pairs of funds.** This helps identify which pairs of funds move together, which can be useful for risk management and portfolio diversification.

5. **Compute drawdowns for each fund.** A drawdown is a decline from a peak to a trough over a specific period. This function also filters drawdowns to include only those that are greater than 10% and computes some metrics on these drawdowns.

6. **Create visualizations.** This includes a plot of the rolling correlation between two funds and the cumulative distribution function of all pairwise correlations.

7. **Generate a text-based financial news article.** This is done using the OpenAI GPT-3 model. The analysis is based on the correlation matrix of returns for various ETFs.

## Visualizations

The script generates two figures. Figure 1 shows the rolling correlation between the funds IVV and IYF. Figure 2 shows the cumulative distribution function of pairwise correlations.

**Figure 1: Rolling Correlation Between IVV and IYF**

![Figure_1](https://github.com/ronimikhaylov/FundCorrelationAnalysis/assets/105238029/f508d549-44a5-41e4-8fae-d91b66580d54)

**Figure 2: CDF of Pairwise Correlations**

![Figure_2](https://github.com/ronimikhaylov/FundCorrelationAnalysis/assets/105238029/c141af34-46ed-4eee-8789-f708d8064257)

## Sample Output

After executing the script, it generates metrics for each fund, including drawdown details and an AI-generated financial news article. Here's a sample output:

```shell
Metrics for IVV
Peak to trough days:  3071 days 00:00:00
Trough to recovery days:  5201 days 00:00:00
Max drawdown:  -0.5650870249291784
Median drawdown:  -0.2230306640825403
Mean drawdown:  -0.24096272481890346
--------------------------------------------------
...
```

```shell
AI prediction based on correlations: 

Investors have long sought to diversify their portfolios in order to reduce risk and maximize returns. One way to do this is to analyze the correlations between different investments. A recent analysis of the returns of various ETFs reveals some interesting insights into the relationships between different funds.

The analysis identified the pairs of ETFs with the highest and lowest correlations. The pair with the highest correlation was IVV and IYJ, with a correlation coefficient of 0.92. This indicates a strong relationship between these two funds, which could be used to predict future price movements. On the other hand, the pair with the lowest correlation was IYE and IYR, with a correlation coefficient of 0.49. This suggests that these two funds are not closely related and could be used to diversify a portfolio.

An investor could use these correlation figures to inform decisions about portfolio diversification. For example, they could choose to invest in pairs of ETFs with a higher correlation, such as IVV and IYJ, in order to reduce risk. Alternatively, they could invest in pairs of ETFs with a lower correlation, such as IYE and IYR, in order to diversify their portfolio.

External factors, such as economic changes or shifts in market sentiment, can also affect these correlations. For example, during a bullish market, the correlations between different ETFs may increase, as investors become more confident and prices rise. Conversely, during a bearish market, the correlations between different ETFs may decrease, as investors become more cautious and prices fall.

It is important to note that historical correlations are not always reliable indicators of future performance. Correlations can change over time, so it is important to regularly monitor the relationships between different investments. Additionally, correlations do not take into account other factors, such as the volatility of the investments, which can also affect future performance.

Given this information, an investor could develop an investment strategy that takes into account these correlation figures. For example, they could invest in higher-correlated pairs of ETFs in order to reduce risk, while also investing in lower-correlated pairs of ETFs in order to diversify their portfolio. Additionally, they could regularly monitor the correlations between different investments in order to identify any changes in the relationships between different funds.

Finally, the analysis also revealed some interesting trends. For example, most of the ETFs had a higher correlation with IVV than with any other ETF. This suggests that IVV is a good benchmark for the other ETFs, and could be used to compare their performance. Additionally, the correlations between the ETFs were generally higher than the correlations between the ETFs and IDU, indicating that the ETFs are more closely related to each other than to IDU. 

Overall, the analysis of the correlations between different ETFs provides valuable insights into the relationships between different funds. By taking into account these correlation figures, an investor can develop an effective investment strategy that maximizes returns and reduces risk.

```

This output provides insights into the behavior of different funds, their interdependencies, as well as their respective drawdowns. It can be used to make informed decisions regarding investment strategies and portfolio diversification.

## Note

The script will generate a Python warning about setting values on a copy of a slice from a DataFrame. This arises from the `pandas` library when performing an operation on a copy of a DataFrame. It is meant to prevent unintended data manipulations, but it doesn't affect the results. You can read more about the warning [here](https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy).

## Conclusion

This script allows users to perform in-depth financial analysis on a range of funds. The analysis not only provides numerical metrics but also a human-readable AI-generated text that can help users make more informed decisions.
